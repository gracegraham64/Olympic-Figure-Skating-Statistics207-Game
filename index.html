<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Olympic Figure Skating Study Game</title>

<style>
body{
  margin:0;
  background:#061a33;
  font-family:Arial;
  color:white;
  text-align:center;
}

canvas{
  display:block;
  margin:auto;
  border:4px solid white;
}

#endingScreen{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  background:rgba(0,0,40,.92);
}

.big{font-size:60px;}
button{padding:12px 20px;font-size:18px;margin-top:20px;}
</style>
</head>

<body>

<h1>Olympic Figure Skating Study Game</h1>
<canvas id="game" width="900" height="500"></canvas>

<div id="endingScreen">
<div id="resultText" class="big"></div>
<div id="finalScore"></div>
<button onclick="location.reload()">Play Again</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

/* ---------- AUDIO ---------- */

const programMusic=new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_115b9bce9f.mp3");
programMusic.loop=true;
programMusic.volume=.3;

const cheer=new Audio("https://cdn.pixabay.com/audio/2021/08/04/audio_3c92a9c73b.mp3");
const gasp=new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_ef6f29e6b7.mp3");
const medalMusic=new Audio("https://cdn.pixabay.com/audio/2022/10/30/audio_48b1c9b95f.mp3");

/* ---------- QUESTIONS ---------- */

const questions=[
{q:"Percent within 1 standard deviation?",a:"68"},
{q:"Percent within 2 standard deviations?",a:"95"},
{q:"Percent within 3 standard deviations?",a:"99.7"},
{q:"Mean=100 SD=10 ‚Üí 1 SD range?",a:"90-110"},
{q:"Mean=50 SD=5 ‚Üí 2 SD range?",a:"40-60"},
{q:"Distribution for empirical rule?",a:"normal"},
{q:"Percent beyond 2 SD one side?",a:"2.5"},
{q:"Mean location in normal distribution?",a:"center"},
{q:"Percent beyond 3 SD total?",a:"0.3"},
{q:"Shape of normal distribution?",a:"bell"}
];

/* ---------- JUMPS ---------- */

const jumps=[
"Single Axel","Double Lutz","Triple Salchow",
"Double Loop","Triple Flip","Double Toe",
"Triple Lutz","Single Loop","Double Axel","Triple Toe"
];

/* ---------- GAME STATE ---------- */

let index=0;
let score=0;
let misses=0;
let state="skating";

/* ---------- SKATER ---------- */

let skater={
x:100,
y:350,
vy:0,
rotation:0,
frame:0,
costume:"#ff3fd8"
};

/* ---------- EFFECTS ---------- */

let sparkles=[];
let trails=[];
let confetti=[];

/* ---------- COMPETITION ARENA ---------- */

function drawArena(){

// ice gradient
let g=ctx.createLinearGradient(0,0,0,500);
g.addColorStop(0,"#e8faff");
g.addColorStop(1,"#ffffff");
ctx.fillStyle=g;
ctx.fillRect(0,0,900,500);

// rink lines
ctx.strokeStyle="#3aa0ff";
ctx.lineWidth=3;
ctx.beginPath();
ctx.moveTo(0,250);
ctx.lineTo(900,250);
ctx.stroke();

// boards
ctx.fillStyle="white";
ctx.fillRect(0,320,900,80);

ctx.fillStyle="#ff0000";
ctx.fillRect(0,320,900,5);

// sponsor panels
for(let i=0;i<6;i++){
ctx.fillStyle="#0a4c8f";
ctx.fillRect(i*150+20,340,100,30);
ctx.fillStyle="white";
ctx.fillText("ISU",i*150+55,360);
}

// crowd seating gradient
let cg=ctx.createLinearGradient(0,0,0,150);
cg.addColorStop(0,"#222");
cg.addColorStop(1,"#555");
ctx.fillStyle=cg;
ctx.fillRect(0,0,900,150);

// audience rows
for(let r=0;r<5;r++){
for(let i=0;i<50;i++){
ctx.fillStyle=`hsl(${Math.random()*360},50%,60%)`;
ctx.beginPath();
ctx.arc(i*18+5,r*20+30,4,0,Math.PI*2);
ctx.fill();
}
}

// arena lights
ctx.fillStyle="rgba(255,255,255,.15)";
ctx.fillRect(0,150,900,50);
}

/* ---------- REALISTIC CARTOON SKATER ---------- */

function drawSkater(){

ctx.save();
ctx.translate(skater.x,skater.y);

// skate trail
trails.push({x:skater.x,y:skater.y,life:20});

// jump rotation
if(state==="jump") skater.rotation+=0.3;
ctx.rotate(skater.rotation);

// legs
ctx.strokeStyle="black";
ctx.lineWidth=4;

let stride=Math.sin(skater.frame/5)*8;

ctx.beginPath();
ctx.moveTo(-6,0);
ctx.lineTo(-10,25);
ctx.moveTo(6,0);
ctx.lineTo(10+stride,25);
ctx.stroke();

// skates
ctx.fillStyle="silver";
ctx.fillRect(-12,25,8,3);
ctx.fillRect(6+stride,25,8,3);

// torso costume
ctx.fillStyle=skater.costume;
ctx.beginPath();
ctx.moveTo(-12,-40);
ctx.lineTo(12,-40);
ctx.lineTo(8,0);
ctx.lineTo(-8,0);
ctx.fill();

// arms (different pose during jump)
ctx.strokeStyle="black";
ctx.lineWidth=3;

ctx.beginPath();
ctx.moveTo(0,-30);
ctx.lineTo(20*Math.sin(skater.frame/4),-10);

ctx.moveTo(0,-30);
ctx.lineTo(-20*Math.sin(skater.frame/4),-10);
ctx.stroke();

// head
ctx.fillStyle="#ffd6b0";
ctx.beginPath();
ctx.arc(0,-50,9,0,Math.PI*2);
ctx.fill();

// sparkle
sparkles.push({
x:skater.x+Math.random()*10-5,
y:skater.y+20,
life:15
});

ctx.restore();
}

/* ---------- PARTICLES ---------- */

function drawParticles(){

sparkles.forEach(p=>{
ctx.fillStyle="white";
ctx.fillRect(p.x,p.y,2,2);
p.life--;
});
sparkles=sparkles.filter(p=>p.life>0);

trails.forEach(t=>{
ctx.fillStyle="rgba(200,240,255,.3)";
ctx.fillRect(t.x-5,t.y+20,10,3);
t.life--;
});
trails=trails.filter(t=>t.life>0);

confetti.forEach(c=>{
ctx.fillStyle=c.color;
ctx.fillRect(c.x,c.y,6,6);
c.y+=3;
});
}

/* ---------- CONFETTI ---------- */

function launchConfetti(){
for(let i=0;i<200;i++){
confetti.push({
x:Math.random()*900,
y:-20,
color:`hsl(${Math.random()*360},70%,60%)`
});
}
}

/* ---------- JUMP ---------- */

function triggerJump(){
state="jump";
skater.vy=-13;
}

function askQuestion(){
const q=questions[index];
const ans=prompt(jumps[index]+"\n\n"+q.q);

if(ans && ans.toLowerCase()==q.a.toLowerCase()){
score+=10;
cheer.play();
}else{
misses++;
gasp.play();
}
}

/* ---------- FINAL SPIN ---------- */

let spin=0;
function finalSpin(){
spin+=0.2;
ctx.save();
ctx.translate(skater.x,skater.y);
ctx.rotate(spin);
ctx.fillStyle=skater.costume;
ctx.fillRect(-12,-40,24,40);
ctx.restore();
}

/* ---------- END ---------- */

function endProgram(){
state="finished";
programMusic.pause();
medalMusic.play();

let medal="Gold";
if(misses==1) medal="Silver";
if(misses==2) medal="Bronze";
if(misses>=3) medal="Lost";

if(medal==="Gold") launchConfetti();

document.getElementById("endingScreen").style.display="flex";
document.getElementById("resultText").innerHTML=
medal==="Lost"?"YOU LOST":medal+" Medal üèÖ";

document.getElementById("finalScore").innerHTML=
"Final Score: "+score+"<br>Missed: "+misses+" / 10";
}

/* ---------- GAME LOOP ---------- */

function update(){

drawArena();

if(state==="skating"){
skater.x+=2;
skater.frame++;

if(skater.x>700){
if(index<10) triggerJump();
else state="spin";
}
}

if(state==="jump"){
skater.y+=skater.vy;
skater.vy+=0.5;

if(skater.y>=350){
skater.y=350;
skater.x=100;
askQuestion();
index++;
state="skating";
}
}

if(state==="spin"){
finalSpin();
setTimeout(endProgram,3000);
state="waiting";
}

drawSkater();
drawParticles();

ctx.fillStyle="black";
ctx.fillText("Score: "+score,20,20);
ctx.fillText("Jump "+(index+1)+" / 10",20,40);

requestAnimationFrame(update);
}

/* ---------- START ---------- */
programMusic.play();
update();
</script>

</body>
</html>
