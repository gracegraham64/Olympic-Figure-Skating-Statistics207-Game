<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Figure Skating Study Game</title>
<style>
body{margin:0;background:#061a33;font-family:Arial;color:white;text-align:center;}
canvas{display:block;margin:auto;border:4px solid white;}
#startScreen,#endingScreen{
  position:absolute;top:0;left:0;width:100%;height:100%;
  display:flex;justify-content:center;align-items:center;flex-direction:column;
  background:rgba(0,0,40,0.9);
}
#questionContainer{
  position:absolute;bottom:20px;left:50%;transform:translateX(-50%);
  display:none;flex-direction:column;align-items:center;
  background:rgba(0,0,0,0.8);padding:10px;border-radius:10px;
}
button{padding:12px 20px;font-size:18px;margin:5px;cursor:pointer;}
.big{font-size:60px;}
</style>
</head>
<body>

<h1>Olympic Figure Skating Study Game</h1>

<div id="startScreen">
  <button id="startButton">Start Game</button>
</div>

<canvas id="game" width="900" height="500" style="display:none"></canvas>

<div id="questionContainer">
  <div id="questionText" style="margin-bottom:10px;font-size:20px;"></div>
  <div id="answers"></div>
</div>

<div id="endingScreen">
  <div id="resultText" class="big"></div>
  <canvas id="medalCanvas" width="500" height="500"></canvas>
  <div id="finalScore" style="margin-top:20px;font-size:24px;"></div>
  <button onclick="location.reload()">Play Again</button>
</div>

<script>
//---------- AUDIO ----------
const programMusic=new Audio("https://cdn.pixabay.com/audio/2023/07/23/audio_1c3e4d8f1e.mp3");
programMusic.loop=true; programMusic.volume=0.5;
const cheer=new Audio("https://cdn.pixabay.com/audio/2021/08/04/audio_3c92a9c73b.mp3");
const aww=new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_ef6f29e6b7.mp3");
const medalMusic=new Audio("https://cdn.pixabay.com/audio/2022/10/30/audio_48b1c9b95f.mp3");

//---------- QUESTIONS ----------
const questions=[
{q:"Percent within 1 SD?",a:"68", options:["68","95","99.7","50"]},
{q:"Percent within 2 SD?",a:"95", options:["68","95","99.7","50"]},
{q:"Percent within 3 SD?",a:"99.7", options:["68","95","99.7","50"]},
{q:"Mean=100 SD=10 ‚Üí 1 SD range?",a:"90-110", options:["80-120","90-110","85-115","100-110"]},
{q:"Mean=50 SD=5 ‚Üí 2 SD range?",a:"40-60", options:["45-55","40-60","35-65","50-55"]},
{q:"Distribution for empirical rule?",a:"normal", options:["skewed","uniform","normal","bimodal"]},
{q:"Percent beyond 2 SD one side?",a:"2.5", options:["5","2.5","1","10"]},
{q:"Mean location in normal distribution?",a:"center", options:["left","right","center","random"]},
{q:"Percent beyond 3 SD total?",a:"0.3", options:["0.3","3","1","0"]},
{q:"Shape of normal distribution?",a:"bell", options:["bell","flat","triangle","uniform"]}
];
const jumps=["Single Axel","Double Lutz","Triple Salchow","Double Loop","Triple Flip","Double Toe","Triple Lutz","Single Loop","Double Axel","Triple Toe"];

//---------- GAME STATE ----------
let score=0, misses=0, index=0;
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const medalCanvas=document.getElementById("medalCanvas");
const mctx=medalCanvas.getContext("2d");
let skater={x:100,y:350,vy:0,frame:0,costume:"#ff3fd8",direction:1,targetX:700,rotation:0};
let sparkles=[],trails=[],confetti=[];
let showingQuestion=false,inAir=false;

//---------- ARENA ----------
function drawArena(){
  const g=ctx.createLinearGradient(0,0,0,500); g.addColorStop(0,"#e8faff"); g.addColorStop(1,"#ffffff");
  ctx.fillStyle=g; ctx.fillRect(0,0,900,500);
  ctx.strokeStyle="#3aa0ff"; ctx.lineWidth=3;
  ctx.beginPath(); ctx.moveTo(0,250); ctx.lineTo(900,250); ctx.stroke();
  ctx.fillStyle="white"; ctx.fillRect(0,320,900,80);
  ctx.fillStyle="#ff0000"; ctx.fillRect(0,320,900,5);
  const cg=ctx.createLinearGradient(0,0,0,150); cg.addColorStop(0,"#222"); cg.addColorStop(1,"#555");
  ctx.fillStyle=cg; ctx.fillRect(0,0,900,150);
  for(let r=0;r<5;r++){for(let i=0;i<50;i++){
    ctx.fillStyle=`hsl(${Math.random()*360},50%,60%)`;
    ctx.beginPath(); ctx.arc(i*18+5,r*20+30,4,0,Math.PI*2); ctx.fill();
  }}
}

//---------- SKATER ----------
function drawSkater(){
  ctx.save(); ctx.translate(skater.x,skater.y); ctx.rotate(skater.rotation);
  const stride=Math.sin(skater.frame/5)*8;
  ctx.strokeStyle="black"; ctx.lineWidth=4;
  ctx.beginPath(); ctx.moveTo(-6,0); ctx.lineTo(-10,25); ctx.moveTo(6,0); ctx.lineTo(10+stride,25); ctx.stroke();
  ctx.fillStyle="silver"; ctx.fillRect(-12,25,8,3); ctx.fillRect(6+stride,25,8,3);
  ctx.fillStyle=skater.costume;
  ctx.beginPath(); ctx.moveTo(-12,-40); ctx.lineTo(12,-40); ctx.lineTo(8,0); ctx.lineTo(-8,0); ctx.fill();
  ctx.strokeStyle="black"; ctx.lineWidth=3;
  ctx.beginPath(); ctx.moveTo(0,-30); ctx.lineTo(20*Math.sin(skater.frame/4),-10);
  ctx.moveTo(0,-30); ctx.lineTo(-20*Math.sin(skater.frame/4),-10); ctx.stroke();
  ctx.fillStyle="#ffd6b0"; ctx.beginPath(); ctx.arc(0,-50,9,0,Math.PI*2); ctx.fill();
  ctx.restore();
}

//---------- PARTICLES ----------
function drawParticles(){
  sparkles.forEach(p=>{ctx.fillStyle="white"; ctx.fillRect(p.x,p.y,2,2); p.life--;});
  sparkles=sparkles.filter(p=>p.life>0);
  trails.forEach(t=>{ctx.fillStyle="rgba(200,240,255,.3)"; ctx.fillRect(t.x-5,t.y+20,10,3); t.life--;});
  trails=trails.filter(t=>t.life>0);
  confetti.forEach(c=>{ctx.fillStyle=c.color; ctx.fillRect(c.x,c.y,6,6); c.y+=3;});
}

//---------- JUMP ----------
function triggerJump(){
  if(!inAir){
    skater.vy=-12-Math.random()*3;
    skater.targetX=Math.random()*700+100;
    skater.direction=skater.targetX>skater.x?1:-1;
    inAir=true;
  }
}

//---------- SHOW QUESTION ----------
function showQuestion(){
  if(showingQuestion || index>=10) return;
  showingQuestion=true;
  const container=document.getElementById("questionContainer");
  const qText=document.getElementById("questionText");
  const answersDiv=document.getElementById("answers");
  container.style.display="flex";
  const q=questions[index];
  qText.innerText=jumps[index]+": "+q.q;
  answersDiv.innerHTML="";
  skater.vy=0; // freeze mid-air
  q.options.forEach(opt=>{
    const btn=document.createElement("button");
    btn.innerText=opt;
    btn.onclick=()=>{
      container.style.display="none"; showingQuestion=false;
      if(opt.toLowerCase()===q.a.toLowerCase()){
        score+=10; cheer.play(); skater.rotation=0; skater.vy=5;
      } else{ misses++; aww.play(); skater.rotation=Math.PI/2; skater.vy=5; }
      index++;
      if(index>=10){setTimeout(endGame,1000);}
    };
    answersDiv.appendChild(btn);
  });
}

//---------- END GAME ----------
function endGame(){
  document.getElementById("game").style.display="none";
  document.getElementById("endingScreen").style.display="flex";
  programMusic.pause(); medalMusic.play();
  let medal="Gold"; if(misses==1) medal="Silver"; else if(misses==2) medal="Bronze"; else if(misses>=3) medal="Lost";
  document.getElementById("resultText").innerText=medal==="Lost"?"YOU LOST":medal+" Medal üèÖ";
  document.getElementById("finalScore").innerText=`Final Score: ${score}/100\nMissed: ${misses}/10`;
  // Medal podium
  mctx.clearRect(0,0,500,500);
  mctx.fillStyle="#888"; mctx.fillRect(150,350,80,50);
  mctx.fillStyle=medal==="Gold"?"#ffd700":medal==="Silver"?"#c0c0c0":"#cd7f32";
  mctx.fillRect(250,300,80,100);
  mctx.fillStyle="#cd7f32"; mctx.fillRect(350,370,80,30);
  mctx.fillStyle=skater.costume; mctx.fillRect(250+40-12,300-40,24,40);
  mctx.beginPath(); mctx.arc(250+40,300-60,30,0,Math.PI*2);
  mctx.fillStyle=medal==="Gold"?"#ffd700":medal==="Silver"?"#c0c0c0":"#cd7f32";
  mctx.fill();
  mctx.fillStyle="black"; mctx.font="20px Arial"; mctx.textAlign="center";
  mctx.fillText(medal,250+40,300-55);
}

//---------- GAME LOOP ----------
function update(){
  ctx.clearRect(0,0,900,500);
  drawArena();
  if(!showingQuestion && !inAir){
    skater.x+=2*skater.direction;
    if(skater.x<50) skater.direction=1;
    if(skater.x>850) skater.direction=-1;
  }
  if(inAir){
    skater.y+=skater.vy;
    skater.vy+=0.5;
    if(skater.y>=350){skater.y=350; skater.vy=0; inAir=false; showQuestion();}
  }
  skater.frame++;
  drawSkater();
  drawParticles();
  ctx.fillStyle="black"; ctx.fillText("Score: "+score,20,20);
  ctx.fillText("Missed: "+misses,20,40);
  requestAnimationFrame(update);
}

//---------- START GAME ----------
document.getElementById("startButton").addEventListener("click",()=>{
  document.getElementById("startScreen").style.display="none";
  canvas.style.display="block";
  programMusic.play().catch(()=>{});
  triggerJump();
  update();
});
</script>
</body>
</html>
